<head>
  <title>Earth/Sky</title>
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="//mrrio.github.io/jsPDF/dist/jspdf.debug.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.0.272/jspdf.debug.js"></script>

  <script>
    $(document).ready(function(){
        $('[data-toggle="popover"]').popover(); 
    });
  </script>

  <script>

   function doMailTo(addr) {
    location.href = "mailto:"+addr+"?subject=Observation Journal Entry&body="+document.getElementById('editable').textContent;
  
    var doc = new jsPDF('p','pt','a4');
    var content = document.getElementById('editable').textContent;

    /*doc.addHTML($("#editable").get(0), function() {
       doc.text(20, 30, 'Earth and Sky Journal Entry');
      doc.save('filename.pdf');
    });*/
  
    doc.text(200, 20, 'Earth and Sky Journal');
    doc.text(20, 50, content);
   // doc.text(20, 30, 'This is client-side Javascript, pumping out a PDF.');
//    doc.addPage();

    doc.save('Test.pdf');

  }

    var doc = new jsPDF();
    var specialElementHandlers = {
        '#editor': function (element, renderer) {
            return true;
        }
    };

    $('#cmd').click(function () {
        console.log("downloading...");
        doc.fromHTML($('#editable').html(), 15, 15, {
            'width': 170,
                'elementHandlers': specialElementHandlers
        });
        doc.save('sample-file.pdf');
    });

  </script>
</head>

<body>
  <div class="container">
    <header>
      <h1>Journal Entries </h1>

      <label class="hide-completed">
        <input type="checkbox" checked="{{hideCompleted}}" />
        Hide Completed Tasks
      </label>

      {{> loginButtons}}

      {{#if currentUser}}
        <form class="new-task">
          <input type="text" name="text" placeholder="Type to add new tasks" />
        </form>
      {{/if}}
    </header>

    <div class="list">
  <div class="panel-group" id="accordion">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapse1">Journal Entry 1: 1/24-1/30</a>
        </h4>
      </div>
      <div id="collapse1" class="panel-collapse collapse in">
        <div contentEditable="true" id="editable" name="editable" placeholder="3 Moon Observations, 3 Sun Observations, 1 Constellation Observation" class="editable">
         
        </div>

        <div name="buttons">
          
           <button class="save"><a href="#" data-toggle="popover" data-content="Journal Content Saved.">Save</a></button>

          <button class="finished"><a href="#" data-toggle="popover" title="Finished" data-content="Journal Entry marked as completed.">Mark as Finished</a></button>

          <button id = "cmd" class="pdf"><a href="#" data-toggle="popover" title="Export as PDF" data-content="Downloaded as pdf document.">Export as PDF</a></button>

          <button id="email" class="email">
          <a href="javascript:doMailTo('someone@domain.com');"> Email </a>
          </button>
        </div>

      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapse2">Journal Entry 2: 1/31-2/6</a>
        </h4>
      </div>
      <div id="collapse2" class="panel-collapse collapse">
        <textarea class="panel-body" placeholder="3 Moon Observations, 3 Sun Observations, 1 Constellation Observation"></textarea>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapse3">Journal Entry 3: 2/7-2/13</a>
        </h4>
      </div>
      <div id="collapse3" class="panel-collapse collapse">
        <textarea class="panel-body" placeholder="3 Moon Observations, 3 Sun Observations, 1 Constellation Observation"></textarea>
      </div>
    </div>
  </div> 
</div>

  <div class="footer">

    <button><a href="#" data-toggle="popover" title="Help" data-content="Fill in Observation Journals for each week. To save your journals, click the Save button.">Help</a></button>

    <button><a href="http://www.rpi.edu/dept/phys/Astro/Ees/">Course Site </a></button>
   <!-- <div id="editor"></div>-->
 
    <button><a href="https://github.com/jaffes2/SkyJournal">Source Code </a></button>
    <h4> Developed by Sarabeth Jaffe </h4> 
    <img src="http://s3.postimg.org/naerqk3un/earthandsky.png" alt="logo"> 

  </div>
</div>


</body>

<template name="task">
  <li class="{{#if checked}}checked{{/if}} {{#if private}}private{{/if}}">
 <button class="delete">&times;</button> 

    <input type="checkbox" checked="{{checked}}" class="toggle-checked" />

<!--     {{#if isOwner}}
      <button class="toggle-private">
        {{#if private}}
          Private
        {{else}}
          Public
        {{/if}}
      </button>
    {{/if}} -->

   <span class="text">{{text}}</span> 
  </li>
</template>

<template name="week2">
  <li class="{{#if checked}}checked{{/if}} {{#if private}}private{{/if}}">
  <!--  <button class="delete">&times;</button> -->

    <input type="checkbox" checked="{{checked}}" class="toggle-checked" />

   <span class="text">Journal Week 2</span> 
  </li>
</template>

